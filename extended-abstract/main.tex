%%
%% sample document for AAMAS'18 conference
%%
%% modified from sample-sigconf.tex
%%
%% see ACM instructions acmguide.pdf
%%
%% AAMAS-specific questions? n.yorke-smith@tudelft.nl
%%

\documentclass[sigconf]{aamas}  % do not change this line!

%% your usepackages here, for example:
\usepackage{booktabs}
\usepackage{xcolor}
 \usepackage{url}
\usepackage{color}
\usepackage{listings}
\usepackage{flushend}



%% do not change the following lines
\setcopyright{ifaamas}  % do not change this line!
\acmDOI{}  % do not change this line!
\acmISBN{}  % do not change this line!
\acmConference[AAMAS'18]{Proc.\@ of the 17th International Conference on Autonomous Agents and Multiagent Systems (AAMAS 2018)}{July 10--15, 2018}{Stockholm, Sweden}{M.~Dastani, G.~Sukthankar, E.~Andr\'{e}, S.~Koenig (eds.)}  % do not change this line!
\acmYear{2018}  % do not change this line!
\copyrightyear{2018}  % do not change this line!
\acmPrice{}  % do not change this line!

%% the rest of your preamble here

\include{macros}
\sloppy
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\title{AgentSpeak(ER): An Extension of AgentSpeak(L) improving
  Encapsulation and Reasoning about Goals}

% put your title here!
%\titlenote{Produces the permission block, and copyright information}

% AAMAS: as appropriate, uncomment one subtitle line; check the CFP
\subtitle{Extended Abstract}
%\subtitle{Industrial Applications Track}
%\subtitle{Socially Interactive Agents Track}
%\subtitle{Blue Sky Ideas Track}
%\subtitle{Robotics Track}
%\subtitle{JAAMAS Track}
%\subtitle{Doctoral Mentoring Program}

%\subtitlenote{The full version of the author's guide is available as \texttt{acmart.pdf} document}


% AAMAS: submissions are anonymous for most tracks
% \author{Paper \#329}  % put your paper number here!

%% example of author block for camera ready version of accepted papers: don't use for anonymous submissions
%
\author{Alessandro Ricci}
%\orcid{1234-5678-9012}
\affiliation{%
  \institution{DISI, University of Bologna}
  \streetaddress{Via Sacchi, 3}
  \city{Cesena} 
  \state{Italy} 
  % \postcode{47521}
}
\email{a.ricci@unibo.it}
%
\author{Rafael H. Bordini}
%\authornote{The secretary disavows any knowledge of this author's actions.}
\affiliation{%
  \institution{POLI-PUCRS}
  \streetaddress{Av. Ipiranga, 6681}
  \city{Porto Alegre, RS} 
  % \postcode{90619-900}
  \state{Brazil} 
}
\email{r.bordini@pucrs.br}
%
\author{Jomi F. H\"ubner}
% \authornote{This author is the
%  one who did all the really hard work.}
\affiliation{%
  \institution{DAS, Federal University of Santa Catarina}
  \streetaddress{PO Box 476}
  \city{Florianópolis, SC} 
  %\postcode{88040-900}
  \country{Brasil}
}
\email{jomi.hubner@ufsc.br}
%
\author{Rem Collier}
\affiliation{%
  \institution{University College of Dublin}
  \city{Dublin}
  \country{Ireland}
}
\email{rem.collier@ucd.ie}

\begin{abstract}  
  In this paper we introduce AgentSpeak(ER), an extension of the
  AgentSpeak(L) language tailored to support encapsulation. The
  AgentSpeak(ER) extension aims at improving the
  style of BDI agent programming along relevant aspects, including
  program modularity and readability, failure handling, and reactive
  as well as goal-based reasoning.
\end{abstract}

\begin{CCSXML}
<ccs2012>
<concept>
<concept_id>10010147.10010178.10010219.10010221</concept_id>
<concept_desc>Computing methodologies~Intelligent agents</concept_desc>
<concept_significance>500</concept_significance>
</concept>
</ccs2012>
\end{CCSXML}

\begin{CCSXML}
<ccs2012>
<concept>
<concept_id>10011007.10011006.10011050</concept_id>
<concept_desc>Software and its engineering~Context specific languages</concept_desc>
<concept_significance>500</concept_significance>
</concept>
</ccs2012>
\end{CCSXML}

\ccsdesc[500]{Computing methodologies~Intelligent agents}
\ccsdesc[500]{Software and its engineering~Context specific languages}

% AAMAS: the ACM CCS are not needed within AAMAS papers
%%
%% The code below should be generated by the tool at
%% http://dl.acm.org/ccs.cfm
%% Please copy and paste the code instead of the example below. 
%%
%\begin{CCSXML}
%<ccs2012>
% <concept>
%  <concept_id>10010520.10010553.10010562</concept_id>
%  <concept_desc>Computer systems organization~Embedded systems</concept_desc>
%  <concept_significance>500</concept_significance>
% </concept>
% <concept>
%  <concept_id>10010520.10010575.10010755</concept_id>
%  <concept_desc>Computer systems organization~Redundancy</concept_desc>
%  <concept_significance>300</concept_significance>
% </concept>
% <concept>
%  <concept_id>10010520.10010553.10010554</concept_id>
%  <concept_desc>Computer systems organization~Robotics</concept_desc>
%  <concept_significance>100</concept_significance>
% </concept>
% <concept>
%  <concept_id>10003033.10003083.10003095</concept_id>
%  <concept_desc>Networks~Network reliability</concept_desc>
%  <concept_significance>100</concept_significance>
% </concept>
%</ccs2012>  
%\end{CCSXML}
%
%\ccsdesc[500]{Computer systems organization~Embedded systems}
%\ccsdesc[300]{Computer systems organization~Redundancy}
%\ccsdesc{Computer systems organization~Robotics}
%\ccsdesc[100]{Networks~Network reliability}


\keywords{Agent-Oriented Programming; Agent Programming Languages; BDI; AgentSpeak(L); Jason; ASTRA; AgentSpeak(ER)}  % put your semicolon-separated keywords here!

\maketitle


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% start of main body of paper

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
\label{sec:intro}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%
% About AgentSpeak(L)
%
{\asl} was introduced in \cite{Rao96} with the purpose of defining an
expressive, abstract language capturing the main aspects of the
Belief-Desire-Intention
architecture~\cite{Bratman88,Georgeff:1987:RRP:1863766.1863818},
featuring a formally defined semantics and an abstract interpreter.
%
The starting point to define the language was implemented systems such
as the
Procedural Reasoning System (PRS)~\cite{Ingrand:1992:ARR:629535.629890}.
% and the Distributed Multi-Agent Reasoning System (dMARS).
%
%
% Contribution
%
Various Agent Programming Languages extended {\asl} with
constructs and mechanisms making it practical from a programming point
of view~\cite{jason06,DBLP:conf/prima/CollierRL15}.

%
Along this line, this paper describes a novel extension of the
{\asl} model --- called {\aser} --- featuring \emph{plan
  encapsulation}, i.e. the possibility to define plans that fully
encapsulate the strategy to achieve the corresponding goals,
integrating both pro-active and reactive behaviour.
%
% Key points
%
%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Motivation}
\label{sec:motivation}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

The main motivation behind {\aser} comes from the experience using
agent programming languages based on the {\asl} model, {\jason} and
ASTRA in particular.
%%
Yet, these issues are relevant for any language based on the BDI
architecture.
%%
%The first issue is about the plan model.

% \subsection{Plan encapsulation}
%
In the BDI model, plans are meant to specify some means by which an
agent can satisfy an end~\cite{Rao96}.
%
In {\asl}, a plan consists of a rule of the kind \textsf{e : c <- b}.
%
The head of a plan consists of a triggering event \textsf{e} and a
context \textsf{c}.
%
The triggering event specifies why the plan was triggered, i.e., the
addition or deletion of a belief or goal.
%
In the following, we refer to plans triggered by event goals
as \emph{g-plans}, and plans triggered by
belief change (including percepts) as \emph{e-plans}.
%
The context specifies those beliefs that should hold given the agent's
current belief base if the plan is to be triggered.
%
The body of a plan is a sequence of actions or (sub-)goals.
%

%
% THE PROBLEM
%
In this approach --- as well as in planning, in general --- the
\emph{means} to achieve a goal (i.e., the plan body) is meant to be
fully specified in terms of the actions the agent should execute and
the (sub-)goals the agent should achieve or test.
%
In practice, when programming such systems, it is often the case that
the strategy (the means) adopted to achieve some goal (the end)
naturally includes ractions --- i.e., reacting to events asynchronously
perceived from the environment, including changes in the beliefs.
% 
This reflects more than just the ability of an agent to change/adapt
its course of actions; it allows the integration of reactivity as a
core ingredient of the strategy to achieve some goal.
%
This revised notion of a plan is not just a programming feature; it
also occurs naturally in human activity. For example, a fisherman with
the goal of catching fish waits for the event of a tug on their line
indicating a fish is on the hook. Reactivity is a key ingredient of many
activities that we perform to achieve specific goals, not only to
handle events that represents errors or unexpected situations (for the
current courses of actions).
%
It follows naturally that this is also an opportunity to extend the
plan model so as to fully \emph{encapsulate} reactions that are
part of the strategy to achieve the goal, as well as the subgoals that
are specific to that particular goal.

%
Let us consider the robot cleaning example used to describe plans
in~\cite{Rao96}. 
%
One of the plans is:

\begin{small}
\begin{verbatim}
+location(waste,X) : location(robot,X) & location(bin,Y)
  <- pick(waste); !location(robot,Y); drop(waste).
\end{verbatim}
\end{small}

\noindent That is, as soon as the robot perceives that there is
waste at its location, then it can pick it up and bring it to the bin.
%
This plan is an essential brick of the the overall strategy to achieve
the goal of cleaning the environment. The problem here is that it is
an implicit rather than explicit goal of the agent (it is done
regardless of the agent currently having the goal of keeping the
environment clean). In practice, we adopt a maintenance
goal~\cite{Duff:2006:PMG:1160633.1160817} to clean the environment,
which includes reacting to cleaning up waste when we see it. In the
above program, this notion cannot be represented and remains in the
mind of the programmer/designer; as there is no g-plan for it, there
is no explicit trace in the agent mental structures about this
goal. It is the ability to explicitly implement this type of behaviour
that motivates the work presented in this paper.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{A Taste of {\aser}}
\label{sec:proposal}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

{\aser} extends the plan model of {\asl} beyond the simple sequence of
actions and goals, so as to \emph{(i)} include the possibility of
specifying reactive behaviour encapsulated within the plan, by means
of e-plans; \emph{(ii)} require that e-plans are always defined within
the scope of some g-plan (i.e., reactions occur always in the context
of some explicit designed goal to be achieved).

The {\aser} syntax for plans extends {\asl} as follows:

{\small
\begin{verbatim}
+!goal : context <: goal_cond { 

  <- ... // main sequence (body actions)

  /* encapsulated e-plans */
  +e1 : c1 <- ...	
  +e2 : c2 <- ....
  
  /* encapsulated g-plans */ 
  +!g1 {    
    <- ...    
    +e3 : c3 <- ... // possible old-style plans
  }	

  /* encapsulated plans catching failures */
  -!g1 : ... <- ... // handles failures in pursuing g1
}
\end{verbatim}}

%
% \noindent Coherently, with the {\asl} model, such a behaviour can be expressed
% in terms of e-plans.
%
% JH: I changed a bit the terminology
\noindent A plan becomes the \emph{scope} of ($i$) a sequence of
actions (referred as \emph{body actions}), ($ii$) a set of
\emph{e-plans}, specifying a reactive behaviour which is active at
runtime only when the plan is in execution, and ($iii$) a set of
\emph{g-plans}, specifying plans to achieve subgoals that are relevant
only in the scope of that plan. The e-plans and g-plans are referred
to as \emph{sub-plans}.
%
The sub-plans may include also reactions to failures occurring when
the plan is executed.

The robot cleaning example becomes:
%
\begin{small}
\begin{verbatim}
+!clean_env  {
   +location(waste,X) : location(robot,X) & location(bin,Y)
      <- pick(waste); !location(robot,Y); drop(waste).
}
\end{verbatim}
\end{small}
%
\noindent We can give an explicit reason for the reactive behaviour by
encapsulating the e-plan within a g-plan, with an explicit goal \texttt{clean\_env}.
%
This is also a particular case where the body of the g-plan happens
not to have any actions.

%
%% RHB: So the failure handling plans for the outer goal were moved
%% inside (as well as out)? I'm against this, but I guess this is a
%% democracy :D
%
Informal semantics of the extended plan model:
\begin{itemize}

\item The sub-plans are part of the strategy which can be applied to
  achieve the g-plan.
%
  The main sequence (body actions) can be empty --- this is typical of
  purely reactive behaviour.
%
  If an event matches the triggering event of a sub-plan while the
  g-plan is executing (i.e., the main sequence is in execution, and
  the sub-plan is applicable according to the context), then the body
  of the sub-plan is stacked on top of the stack of the current
  (g-plan related) intention.
%
  The effect is like an asynchronous interruption of the main
  sequence, to execute the body of the sub-plan first.

\item The execution of the extended plan is considered completed
  if/when the condition described by the \texttt{goal\_cond}
  expression is met.
%
%GoalCondition is analogous to the context: however, if context can be considered to be as the pre-condition to execute the plan, the GoalCondition are like a post-condition, which corresponds to a declarative description of the goal to be achieved. 
%
%Alternatively, the execution of a plan can be forced to complete by using an internal action .done - this is useful everytime the goal condition cannot be effectively or naturally described as a boolean expression.
%
  If \texttt{goal\_cond} is not specified, by default the condition is
  that all actions of the main sequence have been executed and
  completed, in compatibility with the AS model, unless the case in
  which the main plan body is empty: in that case the condition is
  {\texttt{false}} by default.
%
%, i.e. the plan This condition is explicitly represented by the new predefined predicate \texttt{.is\_done}.
\item The body of the plan provides a syntactical and runtime scope of
  the sub-plans, that is: variables used in the goal/context
  expressions are visible also to sub-plans; the lifetime/availability
  of the sub-plans is limited to the time in which the g-plan is in
  execution.
%
\item Failures generated by either the main sequence or by sub-plans
  generate a \texttt{-!g} event.
%
\item An {\asl} plan \texttt{+!g : c <- a.} is an {\aser} g-plan with
  no sub-plans.
\end{itemize}
%
%
%\subsection{Key points}

\noindent This extension turns out to bring a number of important benefits to
agent programming based on the BDI model, namely:
%
\begin{itemize}
\item improving the overall readability of the agent source code,
  reducing fragmentation and increasing modularity;
\item promoting a cleaner goal-oriented programming style by enforcing
  encapsulation of reactive plans within goal plans while still permitting
  purely reactive behaviour;
\item improving intention management, enforcing a one-to-one relation
  between intentions and goals --- so every intention is related to a
  single (top-level) goal;
\item improving failure handling, to support management of failures related 
to plans for reacting to environment events.
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Final Remarks}
\label{sec:conclusion}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%
We formalised the main changes required in the existing formal
semantics of AgentSpeak(L) and experimentally evaluated on initial
prototype implementations of {\aser}, on top of the ASTRA and Jason
platforms\footnote{Available at \url{https://github.com/agentspeakers}.}.
%
Results will be described in a longer version of this paper.

%
As with any new programming language, there is much future work, 
including improving the prototype implementations and comparing performances.
%
More generally, full understanding and evaluation of a programming
language takes many years. We expect in the long term to use \aser\ in
the practical development of multi-agent systems, both for real-world
as well as academic systems (e.g., for the multi-agent programming
contest~\cite{Albrecht18}). However, besides the actual programming
practice, we expect \aser\ to contribute to formal work as
well. Assessing how formal verification of \aser\ systems compares to
the original language is also planned as future work.

%As with any new programming language, there is much future work, 
%including improving the prototype implementations, comparing performances,
%and stressing the value of the new features in the context of
%real-world application case studies.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% bibliography: see CFP for number of permitted pages

\bibliographystyle{ACM-Reference-Format}  % do not change this line!
\bibliography{main}  % put name of your .bib file here


\end{document}
